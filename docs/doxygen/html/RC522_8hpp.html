<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.12"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Caustic lasertag system: include/dev/RC522.hpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Caustic lasertag system
   &#160;<span id="projectnumber">23 October 2016</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('RC522_8hpp.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">RC522.hpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="spi_8hpp_source.html">hal/spi.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="io-pins_8hpp_source.html">hal/io-pins.hpp</a>&quot;</code><br />
<code>#include &lt;stdint.h&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for RC522.hpp:</div>
<div class="dyncontent">
<div class="center"><img src="RC522_8hpp__incl.png" border="0" usemap="#include_2dev_2RC522_8hpp" alt=""/></div>
<map name="include_2dev_2RC522_8hpp" id="include_2dev_2RC522_8hpp">
<area shape="rect" id="node2" href="spi_8hpp.html" title="hal/spi.hpp" alt="" coords="93,80,186,107"/>
<area shape="rect" id="node3" href="io-pins_8hpp.html" title="hal/io&#45;pins.hpp" alt="" coords="5,155,124,181"/>
</map>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="RC522_8hpp__dep__incl.png" border="0" usemap="#include_2dev_2RC522_8hppdep" alt=""/></div>
<map name="include_2dev_2RC522_8hppdep" id="include_2dev_2RC522_8hppdep">
<area shape="rect" id="node2" href="RC522_8cpp.html" title="src/dev/RC522.cpp" alt="" coords="94,87,237,114"/>
<area shape="rect" id="node3" href="MFRC522-wrapper_8hpp.html" title="include/dev/MFRC522\l&#45;wrapper.hpp" alt="" coords="261,80,422,121"/>
<area shape="rect" id="node5" href="head-sensor_8hpp.html" title="include/head&#45;sensor\l/head&#45;sensor.hpp" alt="" coords="430,169,583,211"/>
<area shape="rect" id="node4" href="MFRC522-wrapper_8cpp.html" title="src/dev/MFRC522&#45;wrapper.cpp" alt="" coords="5,177,224,203"/>
<area shape="rect" id="node9" href="rifle_8hpp.html" title="include/rifle/rifle.hpp" alt="" coords="248,177,405,203"/>
<area shape="rect" id="node6" href="device-initializer_8cpp.html" title="src/core/device&#45;initializer.cpp" alt="" coords="220,266,433,293"/>
<area shape="rect" id="node7" href="head-sensor_8cpp.html" title="src/head&#45;sensor/head\l&#45;sensor.cpp" alt="" coords="458,259,619,300"/>
<area shape="rect" id="node8" href="main_8cpp.html" title="src/main.cpp" alt="" coords="643,266,749,293"/>
<area shape="rect" id="node10" href="rifle_8cpp.html" title="src/rifle/rifle.cpp" alt="" coords="68,266,196,293"/>
</map>
</div>
</div>
<p><a href="RC522_8hpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMFRC522.html">MFRC522</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structMFRC522_1_1Uid.html">MFRC522::Uid</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structMFRC522_1_1MIFARE__Key.html">MFRC522::MIFARE_Key</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structMFRC522_1_1RC522IO.html">MFRC522::RC522IO</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a75acaba9e781937468d0911423bc0c35"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="RC522_8hpp.html#a75acaba9e781937468d0911423bc0c35">PROGMEM</a></td></tr>
<tr class="separator:a75acaba9e781937468d0911423bc0c35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a877d32fcf585e92c66414919e58e058c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="RC522_8hpp.html#a877d32fcf585e92c66414919e58e058c">__FlashStringHelper</a>&#160;&#160;&#160;char</td></tr>
<tr class="separator:a877d32fcf585e92c66414919e58e058c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a3eca60932ee4119828944ccd69a6272b"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="RC522_8hpp.html#a3eca60932ee4119828944ccd69a6272b">byte</a> = uint8_t</td></tr>
<tr class="separator:a3eca60932ee4119828944ccd69a6272b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a0e31f2ae877b434ad1cfa62eda66c29b"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="RC522_8hpp.html#a3eca60932ee4119828944ccd69a6272b">byte</a> MFRC522_firmware_referenceV0_0 []&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="RC522_8hpp.html#a0e31f2ae877b434ad1cfa62eda66c29b">PROGMEM</a></td></tr>
<tr class="separator:a0e31f2ae877b434ad1cfa62eda66c29b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a877d32fcf585e92c66414919e58e058c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a877d32fcf585e92c66414919e58e058c">&sect;&nbsp;</a></span>__FlashStringHelper</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define __FlashStringHelper&#160;&#160;&#160;char</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="RC522_8hpp_source.html#l00091">91</a> of file <a class="el" href="RC522_8hpp_source.html">RC522.hpp</a>.</p>

</div>
</div>
<a id="a75acaba9e781937468d0911423bc0c35"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75acaba9e781937468d0911423bc0c35">&sect;&nbsp;</a></span>PROGMEM</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PROGMEM</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="RC522_8hpp_source.html#l00090">90</a> of file <a class="el" href="RC522_8hpp_source.html">RC522.hpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="a3eca60932ee4119828944ccd69a6272b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3eca60932ee4119828944ccd69a6272b">&sect;&nbsp;</a></span>byte</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="RC522_8hpp.html#a3eca60932ee4119828944ccd69a6272b">byte</a> =  uint8_t</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>MFRC522.h - Library to use ARDUINO RFID MODULE KIT 13.56 MHZ WITH TAGS SPI W AND R BY COOQROBOT. Based on code Dr.Leong ( WWW.B2CQSHOP.COM ) Created by Miguel Balboa (circuitito.com), Jan, 2012. Rewritten by Søren Thing Andersen (access.thing.dk), fall of 2013 (Translation to English, refactored, comments, anti collision, cascade levels.) Extended by Tom Clement with functionality to write to sector 0 of UID changeable Mifare cards. Adopted to STM32 and Caustic Lasertag project by Aleksey Bulatov Released into the public domain.</p>
<p>Please read this file for an overview and then MFRC522.cpp for comments on the specific functions. Search for "mf-rc522" on ebay.com to purchase the MF-RC522 board.</p>
<p>There are three hardware components involved: 1) The micro controller: An Arduino 2) The PCD (short for Proximity Coupling Device): NXP <a class="el" href="classMFRC522.html">MFRC522</a> Contactless Reader IC 3) The PICC (short for Proximity Integrated Circuit Card): A card or tag using the ISO 14443A interface, eg Mifare or NTAG203.</p>
<p>The microcontroller and card reader uses SPI for communication. The protocol is described in the <a class="el" href="classMFRC522.html">MFRC522</a> datasheet: <a href="http://www.nxp.com/documents/data_sheet/MFRC522.pdf">http://www.nxp.com/documents/data_sheet/MFRC522.pdf</a></p>
<p>The card reader and the tags communicate using a 13.56MHz electromagnetic field. The protocol is defined in ISO/IEC 14443-3 Identification cards &ndash; Contactless integrated circuit cards &ndash; Proximity cards &ndash; Part 3: Initialization and anticollision". A free version of the final draft can be found at <a href="http://wg8.de/wg8n1496_17n3613_Ballot_FCD14443-3.pdf">http://wg8.de/wg8n1496_17n3613_Ballot_FCD14443-3.pdf</a> Details are found in chapter 6, Type A – Initialization and anticollision.</p>
<p>If only the PICC UID is wanted, the above documents has all the needed information. To read and write from MIFARE PICCs, the MIFARE protocol is used after the PICC has been selected. The MIFARE Classic chips and protocol is described in the datasheets: 1K: <a href="http://www.mouser.com/ds/2/302/MF1S503x-89574.pdf">http://www.mouser.com/ds/2/302/MF1S503x-89574.pdf</a> 4K: <a href="http://datasheet.octopart.com/MF1S7035DA4,118-NXP-Semiconductors-datasheet-11046188.pdf">http://datasheet.octopart.com/MF1S7035DA4,118-NXP-Semiconductors-datasheet-11046188.pdf</a> Mini: <a href="http://www.idcardmarket.com/download/mifare_S20_datasheet.pdf">http://www.idcardmarket.com/download/mifare_S20_datasheet.pdf</a> The MIFARE Ultralight chip and protocol is described in the datasheets: Ultralight: <a href="http://www.nxp.com/documents/data_sheet/MF0ICU1.pdf">http://www.nxp.com/documents/data_sheet/MF0ICU1.pdf</a> Ultralight C: <a href="http://www.nxp.com/documents/short_data_sheet/MF0ICU2_SDS.pdf">http://www.nxp.com/documents/short_data_sheet/MF0ICU2_SDS.pdf</a></p>
<p>MIFARE Classic 1K (MF1S503x): Has 16 sectors * 4 blocks/sector * 16 bytes/block = 1024 bytes. The blocks are numbered 0-63. Block 3 in each sector is the Sector Trailer. See <a href="http://www.mouser.com/ds/2/302/MF1S503x-89574.pdf">http://www.mouser.com/ds/2/302/MF1S503x-89574.pdf</a> sections 8.6 and 8.7: Bytes 0-5: Key A Bytes 6-8: Access Bits Bytes 9: User data Bytes 10-15: Key B (or user data) Block 0 is read-only manufacturer data. To access a block, an authentication using a key from the block's sector must be performed first. Example: To read from block 10, first authenticate using a key from sector 3 (blocks 8-11). All keys are set to FFFFFFFFFFFFh at chip delivery. Warning: Please read section 8.7 "Memory Access". It includes this text: if the PICC detects a format violation the whole sector is irreversibly blocked. To use a block in "value block" mode (for Increment/Decrement operations) you need to change the sector trailer. Use PICC_SetAccessBits() to calculate the bit patterns. MIFARE Classic 4K (MF1S703x): Has (32 sectors * 4 blocks/sector + 8 sectors * 16 blocks/sector) * 16 bytes/block = 4096 bytes. The blocks are numbered 0-255. The last block in each sector is the Sector Trailer like above. MIFARE Classic Mini (MF1 IC S20): Has 5 sectors * 4 blocks/sector * 16 bytes/block = 320 bytes. The blocks are numbered 0-19. The last block in each sector is the Sector Trailer like above.</p>
<p>MIFARE Ultralight (MF0ICU1): Has 16 pages of 4 bytes = 64 bytes. Pages 0 + 1 is used for the 7-byte UID. Page 2 contains the last check digit for the UID, one byte manufacturer internal data, and the lock bytes (see <a href="http://www.nxp.com/documents/data_sheet/MF0ICU1.pdf">http://www.nxp.com/documents/data_sheet/MF0ICU1.pdf</a> section 8.5.2) Page 3 is OTP, One Time Programmable bits. Once set to 1 they cannot revert to 0. Pages 4-15 are read/write unless blocked by the lock bytes in page 2. MIFARE Ultralight C (MF0ICU2): Has 48 pages of 4 bytes = 192 bytes. Pages 0 + 1 is used for the 7-byte UID. Page 2 contains the last check digit for the UID, one byte manufacturer internal data, and the lock bytes (see <a href="http://www.nxp.com/documents/data_sheet/MF0ICU1.pdf">http://www.nxp.com/documents/data_sheet/MF0ICU1.pdf</a> section 8.5.2) Page 3 is OTP, One Time Programmable bits. Once set to 1 they cannot revert to 0. Pages 4-39 are read/write unless blocked by the lock bytes in page 2. Page 40 Lock bytes Page 41 16 bit one way counter Pages 42-43 Authentication configuration Pages 44-47 Authentication key </p>

<p>Definition at line <a class="el" href="RC522_8hpp_source.html#l00087">87</a> of file <a class="el" href="RC522_8hpp_source.html">RC522.hpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a0e31f2ae877b434ad1cfa62eda66c29b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e31f2ae877b434ad1cfa62eda66c29b">&sect;&nbsp;</a></span>PROGMEM</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="RC522_8hpp.html#a3eca60932ee4119828944ccd69a6272b">byte</a> FM17522_firmware_reference [] PROGMEM</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">= {</div><div class="line">    0x00, 0x87, 0x98, 0x0f, 0x49, 0xFF, 0x07, 0x19,</div><div class="line">    0xBF, 0x22, 0x30, 0x49, 0x59, 0x63, 0xAD, 0xCA,</div><div class="line">    0x7F, 0xE3, 0x4E, 0x03, 0x5C, 0x4E, 0x49, 0x50,</div><div class="line">    0x47, 0x9A, 0x37, 0x61, 0xE7, 0xE2, 0xC6, 0x2E,</div><div class="line">    0x75, 0x5A, 0xED, 0x04, 0x3D, 0x02, 0x4B, 0x78,</div><div class="line">    0x32, 0xFF, 0x58, 0x3B, 0x7C, 0xE9, 0x00, 0x94,</div><div class="line">    0xB4, 0x4A, 0x59, 0x5B, 0xFD, 0xC9, 0x29, 0xDF,</div><div class="line">    0x35, 0x96, 0x98, 0x9E, 0x4F, 0x30, 0x32, 0x8D</div><div class="line">}</div></div><!-- fragment -->
<p>Definition at line <a class="el" href="RC522_8hpp_source.html#l00098">98</a> of file <a class="el" href="RC522_8hpp_source.html">RC522.hpp</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_92e8125e54c8e2960f09873d3abc3910.html">dev</a></li><li class="navelem"><a class="el" href="RC522_8hpp.html">RC522.hpp</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.12 </li>
  </ul>
</div>
</body>
</html>
